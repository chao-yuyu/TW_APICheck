# ğŸŒ¦ï¸ å°ç£å¤©æ°£é™é›¨æ©Ÿç‡API

ä¸€å€‹å³æ™‚æŠ“å–å°ç£ä¸­å¤®æ°£è±¡ç½²å¤©æ°£è³‡æ–™çš„APIæœå‹™ï¼Œèƒ½å¤ ç²å–ä»Šå¤©çš„é™é›¨æ©Ÿç‡ä¸¦åˆ¤æ–·æ˜¯å¦æœƒä¸‹é›¨ã€‚

## ğŸ“‹ åŠŸèƒ½ç‰¹è‰²

- ğŸŒ§ï¸ **å³æ™‚å¤©æ°£è³‡æ–™**ï¼šçˆ¬å–ä¸­å¤®æ°£è±¡ç½²å®˜æ–¹ç¶²ç«™
- ğŸ¯ **æ™ºèƒ½åˆ¤æ–·**ï¼šé™é›¨æ©Ÿç‡â‰¥50%è‡ªå‹•åˆ¤å®šç‚º"rain"ï¼Œå¦å‰‡ç‚º"no_rain"
- ğŸ™ï¸ **æ”¯æ´å…¨å°ç¸£å¸‚**ï¼šæ¶µè“‹22å€‹ç¸£å¸‚çš„å¤©æ°£è³‡æ–™
- ğŸš€ **FastAPIæ¡†æ¶**ï¼šç°¡å–®æ˜“ç”¨çš„HTTP APIæ¥å£
- ğŸ”„ **é›™é‡çˆ¬èŸ²ç­–ç•¥**ï¼šçµåˆrequestså’Œseleniumç¢ºä¿è³‡æ–™ç²å–æˆåŠŸ
- ğŸŒ **ä¸­æ–‡æ”¯æ´**ï¼šå®Œæ•´æ”¯æ´ä¸­æ–‡åŸå¸‚åç¨±ï¼Œè‡ªå‹•è™•ç†URLç·¨ç¢¼

## ğŸš€ å¿«é€Ÿé–‹å§‹

### å®‰è£ä¾è³´

```bash
pip install -r requirements.txt
```

### å•Ÿå‹•APIæœå‹™

```bash
python app.py
```

æœå‹™å°‡åœ¨ `http://localhost:8000` å•Ÿå‹•

### æŸ¥çœ‹APIæ–‡æª”

- **Swagger UI**: `http://localhost:8000/docs`
- **ReDoc**: `http://localhost:8000/redoc`

## ğŸ“¡ APIç«¯é»è©³ç´°èªªæ˜

### 1. APIé¦–é  - æŸ¥çœ‹APIè³‡è¨Š
```http
GET /
```

**åŠŸèƒ½**ï¼šæä¾›APIæ¦‚è¦½ã€ä½¿ç”¨èªªæ˜å’Œç«¯é»åˆ—è¡¨

**å›æ‡‰ç¯„ä¾‹**ï¼š
```json
{
  "message": "å°ç£å¤©æ°£é™é›¨æ©Ÿç‡API",
  "description": "ç²å–å°ç£å„ç¸£å¸‚çš„é™é›¨æ©Ÿç‡ï¼Œåˆ¤æ–·æ˜¯å¦æœƒä¸‹é›¨ï¼ˆ>=50%æ©Ÿç‡ï¼‰",
  "endpoints": {
    "/weather": "ç²å–é è¨­åŸå¸‚ï¼ˆå°åŒ—å¸‚ï¼‰çš„å¤©æ°£ç‹€æ…‹",
    "/weather/{city}": "ç²å–æŒ‡å®šåŸå¸‚çš„å¤©æ°£ç‹€æ…‹",
    "/cities": "ç²å–æ”¯æ´çš„åŸå¸‚åˆ—è¡¨",
    "/encode/{city}": "ç²å–åŸå¸‚åç¨±çš„URLç·¨ç¢¼ï¼ˆæ¸¬è©¦ç”¨ï¼‰"
  },
  "usage_examples": {
    "ç›´æ¥ä¸­æ–‡": "http://localhost:8000/weather/è‡ºåŒ—å¸‚",
    "URLç·¨ç¢¼": "http://localhost:8000/weather/%E8%87%BA%E5%8C%97%E5%B8%82",
    "èªªæ˜": "âœ… å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸­æ–‡ï¼Œç€è¦½å™¨æœƒè‡ªå‹•ç·¨ç¢¼"
  },
  "docs": "/docs",
  "redoc": "/redoc"
}
```

### 2. é è¨­å¤©æ°£æŸ¥è©¢ - å°åŒ—å¸‚å¤©æ°£
```http
GET /weather
```

**åŠŸèƒ½**ï¼šå¿«é€Ÿç²å–å°åŒ—å¸‚çš„å¤©æ°£ç‹€æ…‹ï¼Œç„¡éœ€æŒ‡å®šåŸå¸‚åƒæ•¸

**ä½¿ç”¨ç¯„ä¾‹**ï¼š
```bash
curl http://localhost:8000/weather
```

**å›æ‡‰ç¯„ä¾‹**ï¼š
```json
{
  "status": "success",
  "rain_probability": 75,
  "will_rain": true,
  "message": "rain",
  "city": "è‡ºåŒ—å¸‚"
}
```

### 3. æŒ‡å®šåŸå¸‚å¤©æ°£æŸ¥è©¢ - ä¸»è¦åŠŸèƒ½
```http
GET /weather/{city}
```

**åŠŸèƒ½**ï¼šç²å–æŒ‡å®šåŸå¸‚çš„é™é›¨æ©Ÿç‡å’Œå¤©æ°£ç‹€æ…‹

**åƒæ•¸èªªæ˜**ï¼š
- `city`ï¼šåŸå¸‚åç¨±ï¼ˆæ”¯æ´ä¸­æ–‡ï¼Œå¦‚ï¼šè‡ºåŒ—å¸‚ã€é«˜é›„å¸‚ï¼‰
- æ”¯æ´ç›´æ¥ä¸­æ–‡è¼¸å…¥ï¼Œç€è¦½å™¨æœƒè‡ªå‹•è™•ç†URLç·¨ç¢¼

**ä½¿ç”¨ç¯„ä¾‹**ï¼š
```bash
# æ–¹æ³•1ï¼šç›´æ¥ä½¿ç”¨ä¸­æ–‡ï¼ˆæ¨è–¦ï¼‰
curl "http://localhost:8000/weather/è‡ºåŒ—å¸‚"
curl "http://localhost:8000/weather/é«˜é›„å¸‚"
curl "http://localhost:8000/weather/è‡ºä¸­å¸‚"

# æ–¹æ³•2ï¼šæ‰‹å‹•URLç·¨ç¢¼
curl "http://localhost:8000/weather/%E8%87%BA%E5%8C%97%E5%B8%82"
```

**æˆåŠŸå›æ‡‰**ï¼š
```json
{
  "status": "success",
  "rain_probability": 65,
  "will_rain": true,
  "message": "rain",
  "city": "é«˜é›„å¸‚"
}
```

**éŒ¯èª¤å›æ‡‰ï¼ˆä¸æ”¯æ´çš„åŸå¸‚ï¼‰**ï¼š
```json
{
  "status": "error",
  "message": "ä¸æ”¯æ´çš„åŸå¸‚ï¼šå°åŒ—",
  "received_parameter": "å°åŒ—",
  "decoded_city": "å°åŒ—",
  "supported_cities": ["åŸºéš†å¸‚", "æ–°åŒ—å¸‚", "è‡ºåŒ—å¸‚", "..."],
  "tip": "è«‹ä½¿ç”¨æ­£ç¢ºçš„åŸå¸‚åç¨±ï¼Œå¦‚ï¼šè‡ºåŒ—å¸‚ã€é«˜é›„å¸‚ç­‰"
}
```

### 4. æ”¯æ´åŸå¸‚åˆ—è¡¨
```http
GET /cities
```

**åŠŸèƒ½**ï¼šæŸ¥çœ‹æ‰€æœ‰æ”¯æ´çš„å°ç£ç¸£å¸‚åˆ—è¡¨

**ä½¿ç”¨ç¯„ä¾‹**ï¼š
```bash
curl http://localhost:8000/cities
```

**å›æ‡‰ç¯„ä¾‹**ï¼š
```json
{
  "status": "success",
  "cities": [
    "åŸºéš†å¸‚", "æ–°åŒ—å¸‚", "è‡ºåŒ—å¸‚", "æ¡ƒåœ’å¸‚", "æ–°ç«¹ç¸£", "æ–°ç«¹å¸‚",
    "è‹—æ —ç¸£", "è‡ºä¸­å¸‚", "å—æŠ•ç¸£", "å½°åŒ–ç¸£", "é›²æ—ç¸£", "å˜‰ç¾©ç¸£",
    "å˜‰ç¾©å¸‚", "è‡ºå—å¸‚", "é«˜é›„å¸‚", "å±æ±ç¸£", "è‡ºæ±ç¸£", "èŠ±è“®ç¸£",
    "å®œè˜­ç¸£", "æ¾æ¹–ç¸£", "é‡‘é–€ç¸£", "é€£æ±Ÿç¸£"
  ],
  "count": 22,
  "usage_note": "å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸­æ–‡åŸå¸‚åç¨±ï¼Œå¦‚: /weather/è‡ºåŒ—å¸‚"
}
```

### 5. URLç·¨ç¢¼å·¥å…· - æ¸¬è©¦è¼”åŠ©
```http
GET /encode/{city}
```

**åŠŸèƒ½**ï¼šå°‡ä¸­æ–‡åŸå¸‚åç¨±è½‰æ›ç‚ºURLç·¨ç¢¼æ ¼å¼ï¼Œç”¨æ–¼æ¸¬è©¦å’Œèª¿è©¦

**ä½¿ç”¨ç¯„ä¾‹**ï¼š
```bash
curl http://localhost:8000/encode/è‡ºåŒ—å¸‚
```

**å›æ‡‰ç¯„ä¾‹**ï¼š
```json
{
  "status": "success",
  "original": "è‡ºåŒ—å¸‚",
  "encoded": "%E8%87%BA%E5%8C%97%E5%B8%82",
  "encoded_url": "http://localhost:8000/weather/%E8%87%BA%E5%8C%97%E5%B8%82",
  "direct_url": "http://localhost:8000/weather/è‡ºåŒ—å¸‚",
  "note": "å…©ç¨®URLéƒ½å¯ä»¥ä½¿ç”¨"
}
```

### 6. å¥åº·æª¢æŸ¥
```http
GET /health
```

**åŠŸèƒ½**ï¼šæª¢æŸ¥APIæœå‹™æ˜¯å¦æ­£å¸¸é‹è¡Œ

**ä½¿ç”¨ç¯„ä¾‹**ï¼š
```bash
curl http://localhost:8000/health
```

**å›æ‡‰ç¯„ä¾‹**ï¼š
```json
{
  "status": "healthy",
  "message": "APIæœå‹™æ­£å¸¸é‹è¡Œ",
  "encoding_support": "âœ… æ”¯æ´ä¸­æ–‡åŸå¸‚åç¨±ç›´æ¥è¼¸å…¥"
}
```

## ğŸŒŸ å®Œæ•´ä½¿ç”¨ç¯„ä¾‹

### å ´æ™¯1ï¼šæª¢æŸ¥å°åŒ—å¸‚æ˜¯å¦æœƒä¸‹é›¨
```bash
# è«‹æ±‚
curl "http://localhost:8000/weather/è‡ºåŒ—å¸‚"

# å›æ‡‰
{
  "status": "success",
  "rain_probability": 75,
  "will_rain": true,
  "message": "rain",
  "city": "è‡ºåŒ—å¸‚"
}
```

### å ´æ™¯2ï¼šæ‰¹é‡æŸ¥è©¢å¤šå€‹åŸå¸‚
```bash
# æŸ¥è©¢å°åŒ—å¸‚
curl "http://localhost:8000/weather/è‡ºåŒ—å¸‚"

# æŸ¥è©¢é«˜é›„å¸‚
curl "http://localhost:8000/weather/é«˜é›„å¸‚"

# æŸ¥è©¢å°ä¸­å¸‚
curl "http://localhost:8000/weather/è‡ºä¸­å¸‚"
```

### å ´æ™¯3ï¼šåœ¨ç¶²é ç€è¦½å™¨ä¸­ä½¿ç”¨
```
ç›´æ¥åœ¨ç€è¦½å™¨ç¶²å€åˆ—è¼¸å…¥ï¼š
http://localhost:8000/weather/è‡ºåŒ—å¸‚
http://localhost:8000/weather/é«˜é›„å¸‚

æˆ–æŸ¥çœ‹äº¤äº’å¼APIæ–‡æª”ï¼š
http://localhost:8000/docs
```

### å ´æ™¯4ï¼šJavaScript/Ajaxè«‹æ±‚
```javascript
// ä½¿ç”¨fetch API
fetch('http://localhost:8000/weather/è‡ºåŒ—å¸‚')
  .then(response => response.json())
  .then(data => {
    console.log('é™é›¨æ©Ÿç‡:', data.rain_probability + '%');
    console.log('æœƒä¸‹é›¨å—:', data.will_rain ? 'æœƒ' : 'ä¸æœƒ');
  });

// ä½¿ç”¨jQuery
$.get('http://localhost:8000/weather/è‡ºåŒ—å¸‚', function(data) {
  if (data.status === 'success') {
    alert(`${data.city}é™é›¨æ©Ÿç‡: ${data.rain_probability}%`);
  }
});
```

### å ´æ™¯5ï¼šPython requests
```python
import requests

# æŸ¥è©¢å¤©æ°£
response = requests.get('http://localhost:8000/weather/è‡ºåŒ—å¸‚')
data = response.json()

if data['status'] == 'success':
    print(f"{data['city']} é™é›¨æ©Ÿç‡: {data['rain_probability']}%")
    print(f"æœƒä¸‹é›¨å—: {'æœƒ' if data['will_rain'] else 'ä¸æœƒ'}")
```

## ğŸ™ï¸ æ”¯æ´åŸå¸‚

- **åŒ—éƒ¨**ï¼šåŸºéš†å¸‚ã€æ–°åŒ—å¸‚ã€è‡ºåŒ—å¸‚ã€æ¡ƒåœ’å¸‚ã€æ–°ç«¹ç¸£ã€æ–°ç«¹å¸‚
- **ä¸­éƒ¨**ï¼šè‹—æ —ç¸£ã€è‡ºä¸­å¸‚ã€å—æŠ•ç¸£ã€å½°åŒ–ç¸£
- **å—éƒ¨**ï¼šé›²æ—ç¸£ã€å˜‰ç¾©ç¸£ã€å˜‰ç¾©å¸‚ã€è‡ºå—å¸‚ã€é«˜é›„å¸‚ã€å±æ±ç¸£
- **æ±éƒ¨**ï¼šè‡ºæ±ç¸£ã€èŠ±è“®ç¸£ã€å®œè˜­ç¸£
- **é›¢å³¶**ï¼šæ¾æ¹–ç¸£ã€é‡‘é–€ç¸£ã€é€£æ±Ÿç¸£

âš ï¸ **æ³¨æ„**ï¼šè«‹ä½¿ç”¨å®Œæ•´çš„ç¸£å¸‚åç¨±ï¼ˆå¦‚"è‡ºåŒ—å¸‚"è€Œé"å°åŒ—"ï¼‰

## ğŸ¯ é™é›¨åˆ¤æ–·è¦å‰‡

- **é™é›¨æ©Ÿç‡ â‰¥ 50%** â†’ `"will_rain": true`, `"message": "rain"`
- **é™é›¨æ©Ÿç‡ < 50%** â†’ `"will_rain": false`, `"message": "no_rain"`

## ğŸ“ å®Œæ•´å›æ‡‰æ ¼å¼èªªæ˜

### æˆåŠŸå›æ‡‰æ ¼å¼
```json
{
  "status": "success",        // ç‹€æ…‹ï¼šsuccess
  "rain_probability": 75,     // é™é›¨æ©Ÿç‡ï¼ˆ0-100çš„æ•´æ•¸ï¼‰
  "will_rain": true,          // æ˜¯å¦æœƒä¸‹é›¨ï¼ˆbooleanï¼‰
  "message": "rain",          // ç°¡åŒ–è¨Šæ¯ï¼š"rain" æˆ– "no_rain"
  "city": "è‡ºåŒ—å¸‚"            // æŸ¥è©¢çš„åŸå¸‚åç¨±
}
```

### éŒ¯èª¤å›æ‡‰æ ¼å¼
```json
{
  "status": "error",          // ç‹€æ…‹ï¼šerror
  "message": "éŒ¯èª¤æè¿°",       // è©³ç´°éŒ¯èª¤è¨Šæ¯
  "city": "åŸå¸‚åç¨±",         // æŸ¥è©¢çš„åŸå¸‚ï¼ˆå¦‚æœæœ‰ï¼‰
  "received_parameter": "...", // æ¥æ”¶åˆ°çš„åƒæ•¸ï¼ˆåƒ…åŸå¸‚éŒ¯èª¤æ™‚ï¼‰
  "decoded_city": "...",      // è§£ç¢¼å¾Œçš„åŸå¸‚åç¨±ï¼ˆåƒ…åŸå¸‚éŒ¯èª¤æ™‚ï¼‰
  "supported_cities": [...],  // æ”¯æ´çš„åŸå¸‚åˆ—è¡¨ï¼ˆåƒ…åŸå¸‚éŒ¯èª¤æ™‚ï¼‰
  "tip": "ä½¿ç”¨å»ºè­°"           // ä½¿ç”¨æç¤ºï¼ˆåƒ…åŸå¸‚éŒ¯èª¤æ™‚ï¼‰
}
```

## ğŸ”§ æŠ€è¡“æ¶æ§‹

- **Webæ¡†æ¶**ï¼šFastAPI + CORSä¸­é–“ä»¶
- **ASGIæœå‹™å™¨**ï¼šUvicorn
- **çˆ¬èŸ²æŠ€è¡“**ï¼š
  - ä¸»è¦ï¼šSelenium WebDriverï¼ˆè™•ç†å‹•æ…‹å…§å®¹ï¼‰
  - å‚™ç”¨ï¼šrequests + BeautifulSoupï¼ˆéœæ…‹å…§å®¹ï¼‰
- **ç›®æ¨™ç¶²ç«™**ï¼š[ä¸­å¤®æ°£è±¡ç½²ç¸£å¸‚é å ±](https://www.cwa.gov.tw/V8/C/W/County/index.html)
- **è³‡æ–™è§£æ**ï¼šæ­£å‰‡è¡¨é”å¼ + HTMLè§£æ
- **ç·¨ç¢¼è™•ç†**ï¼šUTF-8 + URLç·¨ç¢¼è‡ªå‹•è½‰æ›
- **APIæ–‡æª”**ï¼šè‡ªå‹•ç”Ÿæˆ Swagger UI å’Œ ReDoc

## ğŸ› ï¸ é–‹ç™¼æ¸¬è©¦

### æ¸¬è©¦çˆ¬èŸ²åŠŸèƒ½
```bash
python weather_scraper.py
```

### æ¸¬è©¦APIæœå‹™
```bash
# å•Ÿå‹•æœå‹™
python app.py

# å¥åº·æª¢æŸ¥
curl http://localhost:8000/health

# æ¸¬è©¦é è¨­åŸå¸‚
curl http://localhost:8000/weather

# æ¸¬è©¦æŒ‡å®šåŸå¸‚
curl "http://localhost:8000/weather/è‡ºåŒ—å¸‚"

# æŸ¥çœ‹æ”¯æ´åŸå¸‚
curl http://localhost:8000/cities

# æŸ¥çœ‹APIæ–‡æª”
open http://localhost:8000/docs
```

## âš ï¸ æ³¨æ„äº‹é …

1. **ç¶²ç«™çµæ§‹è®ŠåŒ–**ï¼šä¸­å¤®æ°£è±¡ç½²ç¶²ç«™å¦‚æœ‰æ”¹ç‰ˆï¼Œå¯èƒ½éœ€è¦èª¿æ•´çˆ¬èŸ²é‚è¼¯
2. **è«‹æ±‚é »ç‡**ï¼šå»ºè­°é©åº¦ä½¿ç”¨ï¼Œé¿å…å°å®˜æ–¹ç¶²ç«™é€ æˆè² è·
3. **Chromeç€è¦½å™¨**ï¼šä½¿ç”¨seleniumæ™‚éœ€è¦å®‰è£Chromeç€è¦½å™¨å’ŒChromeDriver
4. **ç¶²è·¯é€£ç·š**ï¼šéœ€è¦ç©©å®šçš„ç¶²è·¯é€£ç·šä¾†å­˜å–æ°£è±¡ç½²ç¶²ç«™
5. **åŸå¸‚åç¨±**ï¼šè«‹ä½¿ç”¨å®Œæ•´æ­£ç¢ºçš„ç¸£å¸‚åç¨±ï¼ˆå¦‚"è‡ºåŒ—å¸‚"è€Œé"å°åŒ—"ï¼‰
6. **ç·¨ç¢¼å•é¡Œ**ï¼šAPIå®Œå…¨æ”¯æ´ä¸­æ–‡ï¼Œç€è¦½å™¨æœƒè‡ªå‹•è™•ç†URLç·¨ç¢¼
7. **ç«¯å£è®Šæ›´**ï¼šFastAPIç‰ˆæœ¬ä½¿ç”¨8000ç«¯å£ï¼ˆåŸFlaskç‰ˆæœ¬ä½¿ç”¨5000ç«¯å£ï¼‰

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ

**Q: åŸå¸‚åç¨±éŒ¯èª¤æ€éº¼è¾¦ï¼Ÿ**
```bash
# æŸ¥çœ‹æ”¯æ´çš„åŸå¸‚åˆ—è¡¨
curl http://localhost:8000/cities

# ä½¿ç”¨å®Œæ•´ç¸£å¸‚åç¨±ï¼Œä¾‹å¦‚ï¼š
# âœ… æ­£ç¢ºï¼š"è‡ºåŒ—å¸‚"ã€"é«˜é›„å¸‚"
# âŒ éŒ¯èª¤ï¼š"å°åŒ—"ã€"é«˜é›„"
```

**Q: çˆ¬èŸ²å¤±æ•—æ€éº¼è™•ç†ï¼Ÿ**
1. æª¢æŸ¥ç¶²è·¯é€£ç·š
2. ç¢ºèªChromeç€è¦½å™¨å·²å®‰è£
3. æª¢æŸ¥æ°£è±¡ç½²ç¶²ç«™æ˜¯å¦æ­£å¸¸é‹ä½œ
4. æŸ¥çœ‹APIæ—¥èªŒè¨Šæ¯ä»¥äº†è§£å…·é«”éŒ¯èª¤

**Q: ä¸­æ–‡ç·¨ç¢¼å•é¡Œï¼Ÿ**
- APIå®Œå…¨æ”¯æ´ä¸­æ–‡åŸå¸‚åç¨±
- å¯ä»¥ç›´æ¥åœ¨ç€è¦½å™¨ç¶²å€åˆ—è¼¸å…¥ä¸­æ–‡
- ç¨‹å¼æœƒè‡ªå‹•è™•ç†URLç·¨ç¢¼è½‰æ›

## ğŸ“„ æˆæ¬Š

æœ¬å°ˆæ¡ˆåƒ…ä¾›å­¸ç¿’å’Œç ”ç©¶ä½¿ç”¨ï¼Œè«‹éµå®ˆç›¸é—œç¶²ç«™çš„ä½¿ç”¨æ¢æ¬¾ã€‚ 